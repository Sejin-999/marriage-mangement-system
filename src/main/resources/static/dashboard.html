<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>ì¶•ì˜ê¸ˆ ê´€ë¦¬ ëŒ€ì‹œë³´ë“œ</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
<div class="container">
    <h1>ğŸ’Œ ì¶•ì˜ê¸ˆ ë“±ë¡</h1>

    <div class="form">
        <input type="text" id="name" placeholder="ì´ë¦„">
        <input type="number" id="amount" placeholder="ê¸ˆì•¡">
        <input type="number" id="mealTicketCount" placeholder="ì‹ê¶Œ ìˆ˜">
        <button onclick="registerMoney()">ë“±ë¡í•˜ê¸°</button>
    </div>

    <hr style="margin: 40px 0;">

    <button class="history-btn" onclick="viewHistory()">ğŸ“œ ì´ë ¥ í™•ì¸í•˜ê¸°</button>
</div>

<script>
    const urlParams = new URLSearchParams(window.location.search);
    const weddingId = urlParams.get("weddingId");

    function registerMoney() {
        const name = document.getElementById("name").value;
        const amount = document.getElementById("amount").value;
        const mealTicketCount = document.getElementById("mealTicketCount").value;

        if (!name || !amount || !mealTicketCount) {
            alert("ëª¨ë“  í•­ëª©ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.");
            return;
        }

        const data = {
            name: name,
            amount: parseInt(amount),
            time: new Date().toISOString(),
            mealTicketCount: parseInt(mealTicketCount),
            weddingId: parseInt(weddingId)
        };

        fetch("/api/money", {
            method: "POST",
            headers: {
                "Content-Type": "application/json"
            },
            body: JSON.stringify(data)
        })
            .then(res => {
                if (res.ok) {
                    alert("ì¶•ì˜ê¸ˆ ë“±ë¡ ì™„ë£Œ!");
                    document.getElementById("name").value = '';
                    document.getElementById("amount").value = '';
                    document.getElementById("mealTicketCount").value = '';
                } else {
                    alert("ë“±ë¡ ì‹¤íŒ¨ âŒ");
                }
            });
    }

    function viewHistory() {
        alert("ì´ë ¥ í™•ì¸ ê¸°ëŠ¥ì€ ë‹¤ìŒ ë‹¨ê³„ì—ì„œ ì œê³µë  ì˜ˆì •ì…ë‹ˆë‹¤.");
    }
</script>
</body>
</html>
